<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Getränke-Übersicht</title>
  <meta name="description" content="Einfache, kostenlose Getränke-Übersicht für euren Verein. Läuft statisch auf GitHub Pages." />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root { color-scheme: light dark; }
    html { font-family: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, sans-serif; }
    @media print {
      .no-print { display: none !important; }
      .print-grid { grid-template-columns: repeat(3, minmax(0, 1fr)); }
      body { background: #fff; }
    }
  </style>
</head>
<body class="bg-gray-50 text-gray-900 dark:bg-gray-950 dark:text-gray-100">
  <!-- Header -->
  <header class="sticky top-0 z-40 backdrop-blur supports-[backdrop-filter]:bg-white/70 dark:supports-[backdrop-filter]:bg-gray-900/60 border-b border-gray-200 dark:border-gray-800">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 py-3 flex items-center gap-3">
      <svg class="w-8 h-8 shrink-0" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
        <path d="M6 22h12"/><path d="M7 10h10l-1 9H8l-1-9Z"/><path d="M8 10V6a4 4 0 1 1 8 0v4"/></svg>
      <h1 class="text-xl sm:text-2xl font-semibold tracking-tight">Getränke-Übersicht</h1>
      <span id="itemCount" class="ml-auto text-sm text-gray-500 dark:text-gray-400"></span>
      <button id="printBtn" class="no-print inline-flex items-center gap-2 rounded-xl border border-gray-300 dark:border-gray-700 px-3 py-1.5 text-sm hover:bg-gray-100 dark:hover:bg-gray-800" title="Drucken">
        <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M6 9V3h12v6"/><path d="M6 18H4a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2h-2"/><path d="M6 14h12v7H6z"/></svg>
        Drucken
      </button>
      <button id="themeToggle" class="no-print inline-flex items-center gap-2 rounded-xl border border-gray-300 dark:border-gray-700 px-3 py-1.5 text-sm hover:bg-gray-100 dark:hover:bg-gray-800" title="Hell/Dunkel">
        <svg id="sun" class="w-4 h-4 hidden" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><circle cx="12" cy="12" r="4"/><path d="M12 2v2m0 16v2M4.93 4.93l1.41 1.41m11.32 11.32 1.41 1.41M2 12h2m16 0h2M4.93 19.07l1.41-1.41m11.32-11.32 1.41-1.41"/></svg>
        <svg id="moon" class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M21 12.79A9 9 0 1 1 11.21 3a7 7 0 0 0 9.79 9.79Z"/></svg>
        <span class="sr-only">Theme umschalten</span>
      </button>
    </div>
  </header>

  <!-- Controls -->
  <section class="no-print border-b border-gray-200 dark:border-gray-800">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 py-4 grid gap-3 md:grid-cols-12">
      <label class="md:col-span-5">
        <span class="block text-xs font-medium text-gray-600 dark:text-gray-400 mb-1">Suche</span>
        <input id="search" type="search" placeholder="z.B. Cola, Bier, Wasser…" class="w-full rounded-xl border border-gray-300 dark:border-gray-700 bg-white/70 dark:bg-gray-900/70 px-3 py-2 outline-none focus:ring-2 focus:ring-blue-500" />
      </label>
      <label class="md:col-span-3">
        <span class="block text-xs font-medium text-gray-600 dark:text-gray-400 mb-1">Kategorie</span>
        <select id="category" class="w-full rounded-xl border border-gray-300 dark:border-gray-700 bg-white/70 dark:bg-gray-900/70 px-3 py-2">
          <option value="">Alle</option>
        </select>
      </label>
      <label class="md:col-span-2">
        <span class="block text-xs font-medium text-gray-600 dark:text-gray-400 mb-1">Sortierung</span>
        <select id="sort" class="w-full rounded-xl border border-gray-300 dark:border-gray-700 bg-white/70 dark:bg-gray-900/70 px-3 py-2">
          <option value="name-asc">Name A–Z</option>
          <option value="name-desc">Name Z–A</option>
          <option value="price-asc">Preis aufsteigend</option>
          <option value="price-desc">Preis absteigend</option>
        </select>
      </label>
      <label class="md:col-span-2 flex items-end">
        <input id="showSizes" type="checkbox" class="mr-2"> <span class="text-sm">Füllmenge anzeigen</span>
      </label>
    </div>
  </section>

  <!-- Grid -->
  <main class="max-w-6xl mx-auto px-4 sm:px-6 py-6">
    <div id="grid" class="grid gap-4 sm:grid-cols-2 lg:grid-cols-3 print-grid"></div>
  </main>

  <!-- Admin (optional) -->
  <section class="no-print max-w-6xl mx-auto px-4 sm:px-6 pb-16">
    <details id="adminPanel" class="rounded-2xl border border-dashed border-gray-300 dark:border-gray-800 p-4">
      <summary class="cursor-pointer select-none font-medium">Daten verwalten (optional)</summary>
      <p class="text-sm text-gray-600 dark:text-gray-400 mt-2">Hier könnt ihr die Getränke-Daten als JSON bearbeiten. Gespeichert wird lokal im Browser (localStorage). Für richtige „Rechte-Verwaltung“ empfiehlt sich, die JSON-Datei direkt im GitHub-Repo zu pflegen.</p>
      <div class="mt-3 grid gap-3 md:grid-cols-2">
        <textarea id="jsonArea" class="rounded-xl border border-gray-300 dark:border-gray-700 bg-white/70 dark:bg-gray-900/70 p-3 min-h-[260px]"></textarea>
        <div class="space-y-3">
          <button id="saveJson" class="inline-flex items-center justify-center w-full rounded-xl px-4 py-2 border border-blue-500 text-blue-700 dark:text-blue-300 hover:bg-blue-50 dark:hover:bg-blue-950/30">Speichern</button>
          <button id="resetJson" class="inline-flex items-center justify-center w-full rounded-xl px-4 py-2 border border-gray-300 dark:border-gray-700 hover:bg-gray-100 dark:hover:bg-gray-800">Auf Standard zurücksetzen</button>
          <button id="exportJson" class="inline-flex items-center justify-center w-full rounded-xl px-4 py-2 border border-emerald-500 text-emerald-700 dark:text-emerald-300 hover:bg-emerald-50 dark:hover:bg-emerald-950/30">Exportieren (JSON)</button>
          <label class="block">
            <span class="text-sm">Importieren (JSON-Datei)</span>
            <input id="importJson" type="file" accept="application/json" class="mt-1 block w-full text-sm" />
          </label>
        </div>
      </div>
    </details>
  </section>

  <footer class="text-center text-xs text-gray-500 dark:text-gray-400 pb-8 no-print">
    <p>Erstellt für Vereine · Statisch, schnell & kostenlos auf GitHub Pages</p>
  </footer>

  <script>
    // --- Beispiel-Daten (kann im Admin-Panel geändert werden) ---
    const DEFAULT_DATA = [
      { id: 1, name: 'Mineralwasser still', category: 'Alkoholfrei', price: 1.50, size: '0,5 L' },
      { id: 2, name: 'Mineralwasser prickelnd', category: 'Alkoholfrei', price: 1.50, size: '0,5 L' },
      { id: 3, name: 'Apfelsaft gespritzt', category: 'Alkoholfrei', price: 2.50, size: '0,5 L' },
      { id: 4, name: 'Cola', category: 'Alkoholfrei', price: 2.20, size: '0,33 L' },
      { id: 5, name: 'Orangenlimonade', category: 'Alkoholfrei', price: 2.20, size: '0,33 L' },
      { id: 6, name: 'Kaffee', category: 'Heißgetränke', price: 2.00, size: '' },
      { id: 7, name: 'Bier hell', category: 'Bier', price: 3.20, size: '0,5 L' },
      { id: 8, name: 'Radler', category: 'Bier', price: 3.20, size: '0,5 L' },
      { id: 9, name: 'Weißwein', category: 'Wein & Sekt', price: 3.00, size: '1/8 L' },
      { id: 10, name: 'Rotwein', category: 'Wein & Sekt', price: 3.00, size: '1/8 L' },
      { id: 11, name: 'Sekt', category: 'Wein & Sekt', price: 3.50, size: '0,1 L' },
      { id: 12, name: 'Schnaps (Marille)', category: 'Spirituosen', price: 2.00, size: '2 cl' }
    ];

    const STORAGE_KEY = 'verein_getraenke_v1';

    // State
    let state = {
      items: [],
      showSizes: false,
      query: '',
      category: '',
      sort: 'name-asc',
    };

    // Helpers
    const € = new Intl.NumberFormat('de-AT', { style: 'currency', currency: 'EUR', minimumFractionDigits: 2 });

    function loadData() {
      try {
        const raw = localStorage.getItem(STORAGE_KEY);
        state.items = raw ? JSON.parse(raw) : DEFAULT_DATA;
      } catch (e) {
        console.warn('Konnte lokale Daten nicht laden, nutze Standard.', e);
        state.items = DEFAULT_DATA;
      }
    }

    function saveData() {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(state.items));
    }

    function uniqueCategories(items) {
      return Array.from(new Set(items.map(i => i.category))).sort((a,b)=>a.localeCompare(b,'de'));
    }

    function applyFilters(items) {
      let res = [...items];
      if (state.query) {
        const q = state.query.toLowerCase();
        res = res.filter(i => (i.name+" "+i.category).toLowerCase().includes(q));
      }
      if (state.category) {
        res = res.filter(i => i.category === state.category);
      }
      switch (state.sort) {
        case 'name-asc': res.sort((a,b)=>a.name.localeCompare(b.name,'de')); break;
        case 'name-desc': res.sort((a,b)=>b.name.localeCompare(a.name,'de')); break;
        case 'price-asc': res.sort((a,b)=>a.price-b.price); break;
        case 'price-desc': res.sort((a,b)=>b.price-a.price); break;
      }
      return res;
    }

    function renderCategories() {
      const select = document.getElementById('category');
      const cats = uniqueCategories(state.items);
      select.innerHTML = '<option value="">Alle</option>' + cats.map(c=>`<option value="${c}">${c}</option>`).join('');
      select.value = state.category;
    }

    function renderGrid() {
      const grid = document.getElementById('grid');
      const data = applyFilters(state.items);
      document.getElementById('itemCount').textContent = `${data.length} Getränke`;
      if (data.length === 0) {
        grid.innerHTML = `<div class="col-span-full text-center text-gray-500">Keine Treffer.</div>`;
        return;
      }
      grid.innerHTML = data.map(item => `
        <article class="rounded-2xl border border-gray-200 dark:border-gray-800 bg-white dark:bg-gray-900 p-4 shadow-sm">
          <div class="flex items-start justify-between gap-3">
            <h2 class="text-lg font-semibold leading-tight">${item.name}</h2>
            <span class="text-base font-semibold">${€.format(item.price)}</span>
          </div>
          <div class="mt-2 flex items-center justify-between text-sm text-gray-600 dark:text-gray-400">
            <span class="inline-flex items-center gap-2">
              <span class="inline-block px-2 py-0.5 rounded-full bg-gray-100 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 text-xs">${item.category}</span>
            </span>
            ${state.showSizes && item.size ? `<span>${item.size}</span>` : ''}
          </div>
        </article>
      `).join('');
    }

    function renderAdmin() {
      const area = document.getElementById('jsonArea');
      area.value = JSON.stringify(state.items, null, 2);
    }

    // Theme
    function applyTheme() {
      const dark = localStorage.getItem('theme') === 'dark' || (localStorage.getItem('theme') === null && window.matchMedia('(prefers-color-scheme: dark)').matches);
      document.documentElement.classList.toggle('dark', dark);
      document.getElementById('sun').classList.toggle('hidden', !dark);
      document.getElementById('moon').classList.toggle('hidden', dark);
    }

    // Init
    function init() {
      loadData();
      renderCategories();
      renderGrid();
      renderAdmin();
      applyTheme();

      // Controls events
      document.getElementById('search').addEventListener('input', (e)=>{ state.query = e.target.value; renderGrid(); });
      document.getElementById('category').addEventListener('change', (e)=>{ state.category = e.target.value; renderGrid(); });
      document.getElementById('sort').addEventListener('change', (e)=>{ state.sort = e.target.value; renderGrid(); });
      document.getElementById('showSizes').addEventListener('change', (e)=>{ state.showSizes = e.target.checked; renderGrid(); });

      document.getElementById('themeToggle').addEventListener('click', ()=>{
        const darkNow = !document.documentElement.classList.contains('dark');
        localStorage.setItem('theme', darkNow ? 'dark' : 'light');
        applyTheme();
      });

      document.getElementById('printBtn').addEventListener('click', ()=> window.print());

      document.getElementById('saveJson').addEventListener('click', ()=>{
        try {
          const parsed = JSON.parse(document.getElementById('jsonArea').value);
          if (!Array.isArray(parsed)) throw new Error('JSON muss ein Array sein');
          state.items = parsed;
          saveData();
          renderCategories();
          renderGrid();
          alert('Gespeichert.');
        } catch (e) {
          alert('Fehler im JSON: ' + e.message);
        }
      });

      document.getElementById('resetJson').addEventListener('click', ()=>{
        if (!confirm('Wirklich auf Standard zurücksetzen?')) return;
        state.items = DEFAULT_DATA;
        saveData();
        renderCategories();
        renderGrid();
        renderAdmin();
      });

      document.getElementById('exportJson').addEventListener('click', ()=>{
        const blob = new Blob([JSON.stringify(state.items, null, 2)], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'getraenke.json';
        document.body.appendChild(a);
        a.click();
        a.remove();
        URL.revokeObjectURL(url);
      });

      document.getElementById('importJson').addEventListener('change', (e)=>{
        const file = e.target.files?.[0];
        if (!file) return;
        const reader = new FileReader();
        reader.onload = () => {
          try {
            const parsed = JSON.parse(reader.result);
            if (!Array.isArray(parsed)) throw new Error('JSON muss ein Array sein');
            state.items = parsed;
            saveData();
            renderCategories();
            renderGrid();
            renderAdmin();
          } catch (err) {
            alert('Fehler beim Import: ' + err.message);
          }
        };
        reader.readAsText(file);
      });
    }

    document.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>
